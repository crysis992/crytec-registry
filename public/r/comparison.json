{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "comparison",
  "title": "Comparison",
  "description": "An interactive image comparison component with hover and drag modes, perfect for showcasing before/after images.",
  "dependencies": ["motion", "lucide-react"],
  "registryDependencies": ["utils"],
  "files": [
    {
      "path": "registry/new-york/ui/custom/comparison.tsx",
      "content": "'use client';\r\n\r\nimport { GripVerticalIcon } from 'lucide-react';\r\nimport { type MotionValue, motion, useMotionValue, useSpring, useTransform } from 'motion/react';\r\nimport {\r\n  type ComponentProps,\r\n  createContext,\r\n  type HTMLAttributes,\r\n  type MouseEventHandler,\r\n  type ReactNode,\r\n  type TouchEventHandler,\r\n  useContext,\r\n  useState,\r\n} from 'react';\r\nimport { cn } from '@/lib/utils';\r\n\r\ntype ImageComparisonContextType = {\r\n  sliderPosition: number;\r\n  setSliderPosition: (pos: number) => void;\r\n  motionSliderPosition: MotionValue<number>;\r\n  mode: 'hover' | 'drag';\r\n};\r\n\r\nconst ImageComparisonContext = createContext<ImageComparisonContextType | undefined>(undefined);\r\n\r\nconst useImageComparisonContext = () => {\r\n  const context = useContext(ImageComparisonContext);\r\n\r\n  if (!context) {\r\n    throw new Error('useImageComparisonContext must be used within a ImageComparison');\r\n  }\r\n\r\n  return context;\r\n};\r\n\r\nexport type ComparisonProps = HTMLAttributes<HTMLDivElement> & {\r\n  mode?: 'hover' | 'drag';\r\n  onDragStart?: () => void;\r\n  onDragEnd?: () => void;\r\n};\r\n\r\nexport const Comparison = ({ className, mode = 'drag', onDragStart, onDragEnd, ...props }: ComparisonProps) => {\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const motionValue = useMotionValue(50);\r\n  const motionSliderPosition = useSpring(motionValue, {\r\n    bounce: 0,\r\n    duration: 0,\r\n  });\r\n  const [sliderPosition, setSliderPosition] = useState(50);\r\n\r\n  const handleDrag = (domRect: DOMRect, clientX: number) => {\r\n    if (!isDragging && mode === 'drag') {\r\n      return;\r\n    }\r\n\r\n    const x = clientX - domRect.left;\r\n    const percentage = Math.min(Math.max((x / domRect.width) * 100, 0), 100);\r\n    motionValue.set(percentage);\r\n    setSliderPosition(percentage);\r\n  };\r\n\r\n  const handleMouseDrag: MouseEventHandler<HTMLDivElement> = (event) => {\r\n    if (!event) {\r\n      return;\r\n    }\r\n\r\n    const containerRect = event.currentTarget.getBoundingClientRect();\r\n\r\n    handleDrag(containerRect, event.clientX);\r\n  };\r\n\r\n  const handleTouchDrag: TouchEventHandler<HTMLDivElement> = (event) => {\r\n    if (!event) {\r\n      return;\r\n    }\r\n\r\n    const containerRect = event.currentTarget.getBoundingClientRect();\r\n    const touches = Array.from(event.touches);\r\n\r\n    handleDrag(containerRect, touches.at(0)?.clientX ?? 0);\r\n  };\r\n\r\n  const handleDragStart = () => {\r\n    if (mode === 'drag') {\r\n      setIsDragging(true);\r\n      onDragStart?.();\r\n    }\r\n  };\r\n\r\n  const handleDragEnd = () => {\r\n    if (mode === 'drag') {\r\n      setIsDragging(false);\r\n      onDragEnd?.();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ImageComparisonContext.Provider value={{ sliderPosition, setSliderPosition, motionSliderPosition, mode }}>\r\n      <div\r\n        aria-label=\"Comparison slider\"\r\n        aria-valuemax={100}\r\n        aria-valuemin={0}\r\n        aria-valuenow={sliderPosition}\r\n        className={cn('relative isolate w-full select-none overflow-hidden', className)}\r\n        onMouseDown={handleDragStart}\r\n        onMouseLeave={handleDragEnd}\r\n        onMouseMove={handleMouseDrag}\r\n        onMouseUp={handleDragEnd}\r\n        onTouchEnd={handleDragEnd}\r\n        onTouchMove={handleTouchDrag}\r\n        onTouchStart={handleDragStart}\r\n        role=\"slider\"\r\n        tabIndex={0}\r\n        {...props}\r\n      />\r\n    </ImageComparisonContext.Provider>\r\n  );\r\n};\r\n\r\nexport type ComparisonItemProps = ComponentProps<typeof motion.div> & {\r\n  position: 'left' | 'right';\r\n};\r\n\r\nexport const ComparisonItem = ({ className, position, ...props }: ComparisonItemProps) => {\r\n  const { motionSliderPosition } = useImageComparisonContext();\r\n  const leftClipPath = useTransform(motionSliderPosition, (value) => `inset(0 0 0 ${value}%)`);\r\n  const rightClipPath = useTransform(motionSliderPosition, (value) => `inset(0 ${100 - value}% 0 0)`);\r\n\r\n  return (\r\n    <motion.div\r\n      aria-hidden=\"true\"\r\n      className={cn('absolute inset-0 h-full w-full object-cover', className)}\r\n      role=\"img\"\r\n      style={{\r\n        clipPath: position === 'left' ? leftClipPath : rightClipPath,\r\n      }}\r\n      {...props}\r\n    />\r\n  );\r\n};\r\n\r\nexport type ComparisonHandleProps = ComponentProps<typeof motion.div> & {\r\n  children?: ReactNode;\r\n};\r\n\r\nexport const ComparisonHandle = ({ className, children, ...props }: ComparisonHandleProps) => {\r\n  const { motionSliderPosition, mode } = useImageComparisonContext();\r\n  const left = useTransform(motionSliderPosition, (value) => `${value}%`);\r\n\r\n  return (\r\n    <motion.div\r\n      aria-hidden=\"true\"\r\n      className={cn(\r\n        '-translate-x-1/2 absolute top-0 z-50 flex h-full w-10 items-center justify-center',\r\n        mode === 'drag' && 'cursor-grab active:cursor-grabbing',\r\n        className,\r\n      )}\r\n      role=\"presentation\"\r\n      style={{ left }}\r\n      {...props}\r\n    >\r\n      {children ?? (\r\n        <>\r\n          <div className=\"-translate-x-1/2 absolute left-1/2 h-full w-1 bg-background\" />\r\n          {mode === 'drag' && (\r\n            <div className=\"z-50 flex items-center justify-center rounded-sm bg-background px-0.5 py-1\">\r\n              <GripVerticalIcon className=\"h-4 w-4 select-none text-muted-foreground\" />\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n    </motion.div>\r\n  );\r\n};\r\n",
      "type": "registry:ui"
    }
  ],
  "type": "registry:ui"
}
